machine:
  environment:
    NODE_ENV: test
  node:
    version: 0.12.6
  timezone:
    Africa/Johannesburg

checkout:
  post:
    - git fetch
    - git config --global user.email "buildbot@munchkins.github.io"
    - git config --global user.name "buildbot"
    - if [ "$CIRCLE_BRANCH" != "master" ]; then git merge --no-edit origin/development; fi

deployment:
  deploy:
    branch: development
    commands:
      - npm run codeclimate
      - git config branch.master.remote origin
      - git config branch.master.merge refs/heads/master
      - git add -A
      - git commit --allow-empty -m "buildbot [ci skip]"
      - git merge --no-edit -s ours -m "buildbot [ci skip]" origin/master
      - git push --force origin HEAD:master
